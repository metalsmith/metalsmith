language: node_js

node_js:
  - "0.12"
  - "iojs"
  - "4"
  - "5"
  - "6"
  - "node"

matrix:
  allow_failures:
    - node_js: "node"
  include:
    - env: BUILD=1
      sudo: required
      services:
        - docker

before_script:
  - export HARMONY_OPTS=$(node --v8-options | grep --only-matching -- '--harmony_generators')

after_success:
  - if [ ! -z "$BUILD" ]; then docker run -v $(pwd):/cwd snapcore/snapcraft sh -c 'cd /cwd && snapcraft'; fi

after_script:
  npm run coveralls
